# sip_call_audio_bridge

`sip_call_audio_bridge` is a C++ application that bridges SIP calls (using PJSIP) to a raw audio TCP socket stream. It allows capturing and sending raw audio data over a TCP connection, facilitating integration with other audio processing or transmission systems.

## Notes

- This is a very simple project; some parts were generated by a LLM. Please review and verify the code before use.
- The application disables the physical sound device and uses the TCP socket for audio input/output.
- Jitter buffer size and codec priorities can be adjusted via command-line options.
- The application outputs JSON-formatted logs to `stdout`.
- **This project has not been tested on Windows.** Use with caution on Windows platforms.

## Requirements

- C++14 compatible compiler.
- PJSIP library with C++ wrapper (pjsua2).
- [nlohmann/json](https://github.com/nlohmann/json) for JSON logging.
- [cxxopts](https://github.com/jarro2783/cxxopts) for command line parsing.
- Networking libraries (BSD sockets on Linux/macOS; Winsock on Windows).

## Build

1. Make sure PJSIP, `nlohmann/json`, and `cxxopts` libraries are installed and accessible on your system.
2. Run the following commands in your project directory:

```bash
mkdir build
cd build
cmake ..
make
```

## Usage

```bash
./sip_call_audio_bridge --user USERNAME --pass PASSWORD --server SIP_SERVER --uri TARGET_SIP_URI [options]
```

### Required options:

- `-u, --user` : SIP account username
- `-p, --pass` : SIP account password
- `-s, --server` : SIP server domain
- `-t, --uri` : Target SIP URI to call

### Optional options:

- `--port` : TCP socket port for audio streaming (default: 0, use 0 for auto-assign)
- `--rate` : Audio clock rate (default: 8000)
- `-c, --codecs` : Comma-separated list of codecs (default: PCMU/8000,PCMA/8000)
- `-j, --jbuf-bytes` : Jitter buffer size in bytes (default: 512)
- `-l, --pjsip-log` : PJSIP native log level (default: 0)
- `-h, --help` : Show help message

## Example

```bash
./sip_call_audio_bridge -u alice -p secret -s sip.example.com -t sip:bob@sip.example.com --port 9999
```

This will register the SIP user `alice` at `sip.example.com` and call the target SIP URI `sip:bob@sip.example.com`, streaming audio over TCP port 9999.
